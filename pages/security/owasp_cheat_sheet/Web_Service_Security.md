概要
この記事では、Webサービスのセキュリティを確保し、関連する攻撃を防止するためのガイダンスを提供することに焦点を当てています。

異なるフレームワーク間の実装の違いにより、このチートシートは高いレベルで保持されていることに注意してください。

輸送機密性
輸送機密性は、サーバーとの間でのWebサービス通信に対する盗聴や中間者攻撃から保護します。

ルール：機密性の高い機能、認証されたセッション、または機密データの転送を含むすべてのWebサービスとの通信は、適切に構成されたTLSを使用して暗号化する必要があります。メッセージ自体が暗号化されていても、TLSはトラフィックの機密性に加えて、整合性保護、再生防御、およびサーバー認証を含む多数の利点を提供するため、これが推奨されます。これを適切に行う方法の詳細については、Transport Layer Security Cheat Sheetを参照してください。

サーバー認証
ルール：TLSを使用して、サービスプロバイダーをサービスコンシューマーに認証する必要があります。サービスコンシューマーは、サーバー証明書が信頼されたプロバイダーによって発行され、期限切れでないこと、取り消されていないこと、サービスのドメイン名と一致していること、およびサーバーが公開鍵証明書に関連付けられた秘密鍵を持っていることを確認する必要があります（何かを適切に署名したり、関連付けられた公開鍵で暗号化されたものを正常に復号化することで）。

ユーザー認証
ユーザー認証は、サービスに接続しようとしているユーザーまたはシステムの正体を確認します。このような認証は通常、Webサービスのコンテナの機能です。

ルール：使用する場合、Basic認証はTLSを介して実行する必要がありますが、Basic認証はHTTPヘッダーで秘密を平文（base64でエンコードされた）で公開するため、推奨されません。

ルール：相互TLSを使用したクライアント証明書認証は、適切な場所で推奨される一般的な認証形式です。参照：Authentication Cheat Sheet。

輸送符号化
SOAP符号化スタイルは、データをソフトウェアオブジェクト間でXML形式に移動し、再び元の形式に戻すことを意図しています。

ルール：クライアントとサーバーの間で同じ符号化スタイルを強制します。

メッセージ整合性
これはデータの静的な保護に用います。トランジット中のデータの整合性はTLSによって簡単に提供できます。

公開鍵暗号を使用する場合、暗号化は機密性を保証しますが、受信者の公開鍵は公開されているため、整合性は保証しません。同じ理由で、暗号化は送信者の同一性を保証しません。

ルール：XMLデータの場合、送信者の秘密鍵を使用してメッセージの整合性を提供するためにXMLデジタル署名を使用します。この署名は、受信者が送信者のデジタル証明書（公開鍵）を使用して検証できます。

メッセージ機密性
機密保持が必要なデータ要素は、強力な暗号化暗号を使用して暗号化する必要があります。これには、ブルートフォース攻撃を防ぐための適切な鍵長が含まれます。

ルール：機密データを含むメッセージは、強力な暗号化暗号を使用して暗号化する必要があります。これは輸送暗号化またはメッセージ暗号化である場合があります。

ルール：受信後に静的に暗号化する必要のある機密データを含むメッセージは、輸送暗号化だけでなく、強力なデータ暗号化で暗号化する必要があります。

承認
Webサービスは、Webアプリケーションがユーザーを認証するのと同じ方法で、Webサービスクライアントに対して認証する必要があります。 Webサービスは、Webサービスクライアントが要求されたデータ（ファイングレインド）に対して特定のアクション（コースグレインド）を実行する権限があることを確認する必要があります。

ルール：Webサービスは、問題のメソッドにアクセスできるかどうかに関係なく、そのクライアントにアクセス権があるかどうかを認証する必要があります。認証のチャレンジに続いて、Webサービスは、要求元が要求されたリソースにアクセスできるかどうかを要求するエンティティの特権を確認する必要があります。これは、すべてのリクエストで行う必要があり、パスワードの変更、メール、住所、支払い、または配送の指示などの重要なリソースに対してチャレンジレスポンス認証メカニズムが追加されているべきです。

ルール：Webサービスアプリケーション内の管理および管理機能へのアクセスは、Webサービス管理者に制限される必要があります。理想的には、管理機能は、これらの機能によって管理されるWebサービスと完全に分離されたアプリケーションに存在するはずです。したがって、通常のユーザーとこれらの重要な機能を完全に分離します。

スキーマの検証
スキーマの検証は、スキーマで定義された制約と構文を強制します。

ルール：Webサービスは、SOAPペイロードを関連するXMLスキーマ定義（XSD）に対して検証する必要があります。

ルール：SOAP Webサービスに対して定義されたXSDは、すべてのパラメーターが受け入れられる最大長と文字セットを最低限定義する必要があります。

ルール：SOAP Webサービスに対して定義されたXSDは、すべての固定形式パラメーター（郵便番号、電話番号、リスト値など）に対して強力な（理想的にはホワイトリスト）検証パターンを定義する必要があります。

コンテンツの検証
ルール：Webサービスは、入力を消費する前に入力を検証する必要があります。 XML入力のコンテンツ検証には、次のものが含まれます。

不正な形式のXMLエンティティに対する検証。
XMLボム攻撃に対する検証。
強力なホワイトリストを使用した入力の検証。
外部エンティティ攻撃に対する検証。
出力のエンコード
Webサービスは、クライアントに送信される出力がデータとして消費されるようにエンコードされていることを確実にする必要があります。これは、Webサービスクライアントが出力をHTMLページに直接または間接的にレンダリングする場合、非常に重要です。

ルール：すべての出力エンコードのルールは、クロスサイトスクリプティング防止チートシートに準じます。

ウイルス保護
SOAPは、ファイルやドキュメントをSOAPメッセージに添付する機能を提供します。これにより、ハッカーがこれらのSOAPメッセージにウイルスやマルウェアを添付する機会が生じます。

ルール：ウイルススキャン技術がインストールされており、可能であればインラインであることを確認してください。ファイルや添付ファイルがディスクに保存される前に確認できるようにします。

ルール：ウイルススキャン技術が定期的に最新のウイルス定義/ルールで更新されていることを確認してください。

メッセージサイズ
Webサービスは、Webアプリケーションと同様に、何千もの大容量のSOAPメッセージを自動的に送信することでDOS攻撃の標的になる可能性があります。これにより、アプリケーションが正当なメッセージに応答できなくなるか、完全にダウンしてしまう可能性があります。

ルール：SOAPメッセージのサイズは、適切なサイズ制限に制限される必要があります。大きなサイズ制限（または全く制限しない）は、成功率の高いDoS攻撃の可能性を高めます。

可用性
リソース制限
通常の操作中、WebサービスはCPUサイクルやメモリなどの計算リソースを必要とします。機能不全が発生した場合や攻撃を受けた場合、Webサービスは過剰に多くのリソースを必要とし、ホストシステムが不安定になる可能性があります。

ルール：期待されるサービスレートに基づいて、Webサービスが使用できるCPUサイクルの量を制限して、安定したシステムを確保します。

ルール：システムがメモリ不足に陥らないように、Webサービスが使用できるメモリ量を制限します。ホストシステムがメモリ不足に陥った場合、場合によってはプロセスを終了してメモリを解放することがあります。

ルール：同時に開いているファイル、ネットワーク接続、および開始されたプロセスの数を制限します。

メッセージスループット
スループットは、特定の期間内に処理されるWebサービスリクエストの数を表します。

ルール：DoSのような状況に遭遇しないように、構成を最大のメッセージスループットに最適化します。

XML DoS保護
XML DoSは、おそらくWebサービスに対する最も深刻な攻撃です。そのため、Webサービスは次の検証を提供する必要があります。

ルール：再帰ペイロードに対する検証。

ルール：サイズが大きすぎるペイロードに対する検証。

ルール：XMLエンティティ拡張に対する保護。

ルール：長すぎる要素名に対する検証。SOAPベースのWebサービスを使用している場合、要素名はそれらのSOAPアクションです。

この保護は、XMLパーサー/スキーマ検証ツールによって提供される必要があります。検証するために、テストケースを構築して、パーサーがこれらのタイプの攻撃に耐性があることを確認します。

エンドポイントセキュリティプロファイル
ルール：Webサービスは、少なくともWebサービス間の相互運用性（WS-I）基本プロファイルに準拠する必要があります。