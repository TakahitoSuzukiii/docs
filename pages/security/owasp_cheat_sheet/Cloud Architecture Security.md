概要
このチートシートでは、クラウドアーキテクチャの作成およびレビュー時に遵守すべき一般的で必要不可欠なセキュリティパターンについて説明します。各セクションでは、検討すべき特定のセキュリティガイドラインまたはクラウドデザイン決定がカバーされます。このシートは、中規模から大規模なエンタープライズシステム向けに作成されており、より小規模な組織には不要なオーバーヘッド要素が含まれています。

リスク分析、脅威モデリング、および攻撃サーフェス評価
どのアプリケーションアーキテクチャにおいても、リスクと脅威を理解することは非常に重要です。誰もが予算やリソースをセキュリティに完全に割り当てることはできませんので、適切にセキュリティリソースを割り当てることが必要です。したがって、企業は次のことを特定するためにリスク評価、脅威モデリング活動、および攻撃サーフェス評価を実施する必要があります。

アプリケーションが直面する可能性のある脅威
それらの脅威が攻撃として実現する可能性
それらの攻撃が対象とする攻撃サーフェス
その攻撃によってデータや機能を失うことのビジネスへの影響
これらすべては、アーキテクチャのセキュリティの範囲を適切に設定するために必要です。ただし、これらは詳細に議論すべきトピックであり、健全なセキュアアーキテクチャの議論の一環としてさらに調査するために、以下のリソースリンクを使用してください。

脅威モデリングチートシート

攻撃サーフェス分析チートシート

CISAサイバーリスクアセスメント
公共およびプライベートコンポーネント
セキュアオブジェクトストレージ
オブジェクトストレージには通常、次のようなデータアクセスオプションがあります。

組み込みのアイデンティティおよびアクセス管理ポリシーを使用してリソースにアクセスする

暗号化された署名付きのURLとHTTPリクエストを使用する

パブリックストレージを直接アクセスする
IAMアクセス
この方法は、エフェメラルまたは永続的なインフラストラクチャで実行される管理されたサービスや自己管理されたサービスなどのツールへの間接的なアクセスを含みます。このインフラストラクチャには、ユーザーの代わりにオブジェクトストレージとやり取りする永続的なコントロールプレーンIAM資格情報が含まれます。この方法は、アプリケーションに他のユーザーインターフェイスやデータシステムが利用可能である場合、ストレージシステムの可能な限り多くを隠すことが重要な場合、または情報がエンドユーザーに表示されない/表示されない場合（メタデータ）に最適です。これは、リソースへのアクセスをより良く追跡および制御するためにWeb認証およびロギングと組み合わせて使用できます。このアプローチの主要なセキュリティ上の懸念点は、脆弱性を含む可能性のある開発されたコードやポリシーに依存していることです。

利点 欠点
データへの直接アクセスなし 広範なIAMポリシーの使用
ユーザーにオブジェクトストレージが表示されない 資格情報の紛失により、コントロールプレーンAPIにアクセス可能になる
識別可能でログ記録可能なアクセス 資格情報がハードコードされる可能性がある
このアプローチは、機密性の高いユーザーデータに対して許容されるが、データを適切に保護するために厳格なコーディングおよびクラウドのベストプラクティスに従う必要があります。

署名付きURL
オブジェクトストレージのURL署名は、エンティティがストレージ内のリソースにアクセスできることを暗号的に保証するいくつかの方法を使用するか、静的または動的に生成されたURLを使用することを含みます。これは、特定のユーザーファイルへの直接アクセスが必要または好ましい場合に最適です。ファイル転送のオーバーヘッドがないため、ユーザーデータにのみこの方法を使用することをお勧めします。この方法はセキュアである可能性がありますが、注目すべき欠点があります。署名付きURLの生成方法がカスタムであり、動的でインジェクション可能である場合、またはURLが与えられた場合、誰でもリソースに匿名でアクセスできる可能性があります。また、署名付きURLの有効期限が切れる時期を開発者が考慮する必要があり、アプローチの複雑さが増します。

利点 欠点
1つのリソースへのアクセスのみ 匿名アクセス
ユーザーにオブジェクトストレージがほとんど表示されない URLを持っている人は誰でもアクセスできます
効率的なファイル転送 カスタムコードでインジェクションが可能な可能性があります
パブリックオブジェクトストレージ
これはリソースの保存および配布には適していない方法であり、公開された、機密でない、一般的なリソースにのみ使用する必要があります。このストレージアプローチは、クラウド環境への脅威行為者の追加の偵察を提供し、この構成で何らかの期間にわたって保存されているデータは、公にアクセスされると見なす必要があります。

利点 欠点
多くのリソースへの効率的なアクセス 誰でもアクセスできます/プライバシーなし
シンプルなパブリックファイル共有 オブジェクトへの非認証アクセス
完全なファイルシステムへの可視性
保存された情報を偶然漏洩させる
VPCおよびサブネット
Virtual Private Cloud（VPC）およびパブリック/プライベートネットワークサブネットは、クラウドシステム内の独自のチャンクにアプリケーションとそのネットワークをセグメント化することを可能にし、セキュリティのレイヤーを追加します。他のプライベートvsパブリックのトレードオフとは異なり、アプリケーションは通常、成熟したアーキテクチャの中でこれらのコンポーネントのほとんどまたはすべてを組み込むでしょう。以下にそれぞれについて説明します。

VPC
VPCは、アプリケーション内でネットワーク境界を作成するために使用されます。VPCは、パブリックおよびプライベートのいくつかのサブネットで構成されます。VPCを使用して、次のことができます。

同じクラウドアカウント内のアプリケーション全体を分離します。

別々のVPCに分離された独立したネットワーク内のアプリケーションの大きなコンポーネントを分離します。

異なる顧客またはデータセットに使用される重複したアプリケーション間に分離を作成します。
パブリックサブネット
パブリックサブネットには、インターネットに面したプレゼンスを持つコンポーネントが含まれます。サブネットには、サブネット内のコンポーネントがインターネットに直接接続できるようにするネットワークルーティング要素が含まれます。一部のユースケースには次のものがあります。

フロントエンドWebアプリケーションなどの公開リソース。

ロードバランサーやルーターなどのアプリケーションの初期接点。

エンジニアのアクセスポイント、バスチオンなど（これらは、エンジニアリング/デプロイメントが間違っている場合、非常に安全ではない可能性があります）。
プライベートサブネット
プライベートサブネットには、直接インターネットアクセスを持つべきでないコンポーネントが含まれます。サブネットには、パブリックサブネットに接続するネットワークルーティングが含まれる場合があります。プライベートサブネットは、次のような場合に適しています。

データベースおよびデータストア。

バックエンドサーバーと関連するファイルシステム。

直接インターネットアクセスが適していない場合。

簡単なアーキテクチャ例
以下の簡単なアーキテクチャ図を考えてみてください。VPCには、アプリケーションのすべてのコンポーネントが含まれますが、要素はシステム内の役割に応じて特定のサブネットに配置されます。このアプリケーションとの相互作用の通常のフローは次のようになります。

いくつかの種類のインターネットゲートウェイ、APIゲートウェイ、または他のインターネットに面したコンポーネントを介してアプリケーションにアクセスします。
このゲートウェイは、パブリックサブネット内のロードバランサーまたはWebサーバーに接続します。両方のコンポーネントは公開機能を提供し、それに応じてセキュリティが確保されます。
これらのコンポーネントは、プライベートVPC内に含まれるデータベースまたはバックエンドサーバーと対応する適切なコンポーネントと対話します。これらの接続はより制限されており、おそらく「ソフト」なバックエンドシステムへの不必要なアクセスを防ぎます。
VPC図
注：この図は、サブネット間のインターフェイスに関するルーティングおよびIAM要素を省略しています。これは、シンプルさとサービスプロバイダーに依存しないようにするためです。

このアーキテクチャにより、弱くなったバックエンドコンポーネントやデータベースなどの高リスクサービスがインターネットに直接公開されることが防がれます。また、一般的な公共機能はインターネットへの追加のルーティングオーバーヘッドを避けるため、インターネットに公開されます。このアーキテクチャは、エントリーポイントでのセキュリティへの焦点を当て、機能を分離し、非公開または機密情報を外部の当事者がアクセスしにくいプライベートサブネット内に配置することで、より簡単にセキュリティを確保できます。

トラスト境界
トラスト境界は、システム内のコンポーネント間でトラストの決定を行う必要があるポイントです。別の言い方をすれば、この境界は、ポテンシャルに異なる信頼レベルを持つ2つのコンポーネントが出会うポイントです。これらの境界は、ユーザーがアプリケーションと対話する際の信頼度、またはクラウドアーキテクチャ内のコード機能やコンポーネント間の特定のクレームを信頼または検証する場所としてスケールが変わります。しかし、一般的には、各コンポーネントが正しくかつ安全に機能することを信頼することが十分です。したがって、トラスト境界はおそらくクラウドコンポーネント間、およびアプリケーションとエンドユーザーおよび他のベンダーなどのサードパーティ要素との間の接続で発生するでしょう。

たとえば、以下のアーキテクチャを考えてみてください。APIゲートウェイが計算インスタンス（エフェメラルまたは永続）に接続し、それが永続ストレージリソースにアクセスします。別に、呼び出し元の認証、認可、および/またはアイデンティティを検証できるサーバーが存在します。これは、これらのリソースへのアクセスを制御するOAuth、IAM、またはディレクトリシステムの一般的な表現です。さらに、ストレージリソースへのアクセスを制御するエフェメラルIAMサーバーが存在します（IAMアクセスセクションで説明した方法を使用して）。点線で示されているように、これらのコンピュートコンポーネント間、APIゲートウェイと認証/アイデンティティサーバーとの間にトラスト境界が存在します。これらの要素の多くまたはすべてが同じアプリケーション内に存在する可能性があるにもかかわらずです。

さまざまな信頼レベルの探索
アーキテクトは、リスクスコア/耐性、プロジェクトの速度、および主観的なセキュリティ目標など、信頼構成を選択する必要があります。以下の各例では、信頼境界の場所、さまざまなトラストレベル、およびそれに関連するセキュリティリスクのさまざまな側面について検討します。それぞれの例は、セキュリティへの懸念、コンプライアンスレギュレーション、および運用上の慎重さを補完します。アプリケーションアーキテクトとセキュリティエンジニアは、トラスト境界の設計と置換を計画するときに、これらのトレードオフに慎重に配慮する必要があります。

アーキテクチャ的懸念
ユースケース 安全なユースケースの懸念
ウェブアプリケーション ユーザーによって提供されたデータを操作する
エンタープライズウェブサービス 機密データや企業内情報の検証
サードパーティAPI ユーザーに提供されたデータに関連するクレジットカード情報の処理
マイクロサービス/システム アプリケーションの状態または一貫性の管理
リスク軽減
信頼レベルの強化 セキュリティの懸念とトレードオフ
トラストレベルが強すぎる 拡張性の欠如、過度の管理の複雑さ
トラストレベルが弱すぎる 不必要なデータ漏洩、ユーザーアクセスの悪用
ポリシー/コンプライアンスリスク
企業の監査および規制準拠性 信頼の可視性と一貫性
データの保護 情報漏洩の防止、データ保護の不足
ユーザーアクセス管理 不必要なユーザーアクセス、特権の乱用
運用効率
インフラストラクチャのスケーラビリティ アプリケーションの継続的な成長と更新
技術的負債の蓄積 過度に複雑なアーキテクチャ、テストの不足
異常検知とインシデント応答 セキュリティインシデントの追跡と報告
構成管理 複雑なネットワーク、アクセス管理、およびログ記録
トラストレベルとコンポーネントデザインのベストプラクティス
セキュアなクラウドアーキテクチャを作成するために、アプリケーションデザイナーは次の手法を検討する必要があります。

アプリケーションのすべてのコンポーネントに対して適切な信頼レベルを定義します。これには、データを保存、処理、および伝送するすべての要素が含まれます。
セキュリティ上の必要性に基づいて、トラストレベルを各コンポーネントに割り当てます。これは、データが移動する場所、データが保持される場所、およびアクセスされる場所を含みます。
セキュリティ上の最小限の特権を持つ原則に従って、各コンポーネントが必要とする機能にのみアクセスできるようにします。
セキュリティリスクとコンプライアンスのニーズを評価し、トラストレベルの変更や追加が必要な場合は適切な手順を実行します。
アプリケーションの全体的なセキュリティとデータ保護の責任を明確にし、チーム全体での責任を共有します。
運用プロセスとトラブルシューティング手順を実装し、必要に応じてインシデント対応計画を作成します。
セキュリティ標準と業界ベストプラクティスに常に従い、アプリケーションとインフラストラクチャのセキュリティを定期的に監査およびレビューします。
これらの手法とベストプラクティスに従うことで、クラウドベースのアプリケーションのセキュリティを強化し、データおよびユーザー情報を効果的に保護できます。