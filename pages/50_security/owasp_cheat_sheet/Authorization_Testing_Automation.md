**認可テスト自動化チートシート**

概要：
このチートシートは、アプリケーションの保護対策を実装する際に、アプリケーションの認可を定義および実装することがプロセスの中で最も重要な部分の1つであることを示しています。作成フェーズ中に行われるすべてのチェックとセキュリティ監査にもかかわらず、認可に関する問題の大部分は、更新されたリリースで機能が追加/変更され、その影響がアプリケーションの認可にどのように影響するかを決定せずに発生します（通常、コストや時間の問題が理由です）。

この問題に対処するために、開発者には認可の評価を自動化し、新しいリリースが作成されたときにテストを実行することを推奨します。これにより、チームがアプリケーションへの変更が認可の定義および/または実装と競合するかどうかを把握できます。

文脈：
通常、認可には2つの要素（次元とも呼ばれる）が含まれます：機能とそれにアクセスする論理ロール。ビジネスデータレベルでのフィルタリングを含むアクセスを定義するために、Dataと呼ばれるサードパーティの次元が追加されることがあります。

通常、各認可の2つの次元は、認可行列と呼ばれるスプレッドシートにリストされるべきです。認可がテストされるとき、論理ロールは時々視点と呼ばれます。

目的：
このチートシートは、認可行列で認可テストを自動化するアプローチを生成するのに役立ちます。開発者は自分自身の認可テストを自動化するためのアプローチを設計する必要があるため、このチートシートは、RESTサービスを公開するアプリケーションの1つの可能な実装に対する認可テストの自動化の可能なアプローチを示します。

提案：
認可行列を自動化する準備：

認可行列のテストを自動化する準備をする前に、以下の作業が必要です：

- プログラムによって行列を簡単に処理できるピボット形式のファイルで認可行列を形式化します。
- 認可の組み合わせをフォローアップする必要があるときに、人間が読み取りおよび更新できるようにします。
- 異なる組み合わせを簡単に作成できるように、認可の階層構造を設定します。
- アプリケーションの実装に使用される技術と設計からできるだけ独立した状態を作成します。
- 認可行列ピボットファイルを入力ソースとして完全に使用する統合テストセットを作成します。これにより、次の利点が得られます：

    - 認可行列ピボットファイルが更新された場合の最小限のメンテナンス。
    - 認可行列を満たさないソース認可の組み合わせの失敗したテストの明確な指示。
    
認可行列ピボットファイルを作成する：

この例では、認可行列を形式化するためにXML形式を使用しています。

このXML構造には3つの主要セクション（またはノード）があります：

- rolesノード：システムで使用される可能性のある論理ロールを説明し、ロールの一覧を提供し、異なるロール（認可レベル）を説明します。
- servicesノード：システムによって公開された利用可能なサービスの一覧を提供し、それらのサービスの説明を提供し、それらを呼び出すことができる関連する論理ロールを定義します。
- services-testingノード：URLやパスからの入力データ以外のデータを使用するサービスの場合、それぞれのサービスに対するテストペイロードを提供します。

このサンプルは、XMLを使用して認可がどのように定義されるかを示しています：

（中略）

統合テストの実装：

統合テストを作成するには、コードの最大限の因数化と、1つの視点（POV）ごとの1つのテストケースを使用する必要があります。これにより、検証がアクセスレベル（論理ロール）ごとにプロファイル化され、エラーのレンダリング/識別が容易になります。

この統合テストでは、JAXBを使用してXMLをマーシャリングしてJavaオブジェ

クトに、そしてオブジェクトを再度XMLにアンマーシャリングすることで、解析、オブジェクトマッピング、および認可行列へのアクセスが実装されています。これらの機能は、テストを実装する開発者のコードを制限し、テストを実行する責任を持つ開発者の手を解放します。

以下は、統合テストケースクラスのサンプル実装です：

（中略）

認可の問題が検出された場合（または問題が検出された場合）、出力は次のようになります：

（中略）

監査/レビューのための認可行列のレンダリング：

認可行列が人間が読み取ることができる形式（XML）で保存されていても、XMLファイルの即時レンダリング表現を表示して、潜在的な不整合を見つけやすくし、認可行列に関するレビュー、監査、および議論を容易にすることができます。

このタスクを達成するために、次のXSLスタイルシートを使用できます：

（中略）

レンダリングの例：

（中略）

プロトタイプのソース：

GitHubリポジトリ