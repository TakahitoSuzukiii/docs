概要：
このチートシートは、SQLおよびNoSQLデータベースを安全に設定するためのアドバイスを提供します。これは、アプリケーション開発者がデータベースの管理を担当する場合に使用するように設計されています。SQLインジェクション攻撃に対する保護の詳細については、「SQLインジェクション防止チートシート」を参照してください。

バックエンドデータベースの保護：
アプリケーションのバックエンドデータベースは、他のサーバーから分離され、可能な限り少ないホストとのみ接続するようにする必要があります。このタスクは、システムおよびネットワークアーキテクチャに依存します。次の提案を検討してください。

ネットワーク（TCP）アクセスを無効にし、すべてのアクセスをローカルソケットファイルまたは名前付きパイプを介して行うようにする。
データベースをlocalhostにのみバインドするように構成する。
ファイアウォールルールで特定のホストへのネットワークポートアクセスを制限する。
データベースサーバーをアプリケーションサーバーから分離した別のDMZに配置する。
データベースと共に使用されるWebベースの管理ツール（phpMyAdminなど）も同様の保護が必要です。
アプリケーションが信頼できないシステム（例：厚いクライアント）で実行されている場合、常に適切なアクセス制御と制限を強制できるAPIを介してバックエンドに接続する必要があります。厚いクライアントからバックエンドデータベースへの直接接続は絶対に行われてはいけません。

トランスポート層保護の実装：
ほとんどのデータベースのデフォルト構成は、暗号化されていないネットワーク接続から始まりますが、一部は初期認証を暗号化します（Microsoft SQL Serverなど）。初期認証が暗号化されていても、トラフィックの残りは暗号化されず、すべての種類の機密情報がネットワークを介してクリアテキストで送信されます。次の手順を実行して暗号化されていないトラフィックを防止する必要があります。

データベースを暗号化された接続のみ許可するように構成する。
サーバーに信頼できるデジタル証明書をインストールする。
クライアントアプリケーションをTLSv1.2+および現代の暗号（AES-GCMやChaCha20など）を使用して接続するようにする。
クライアントアプリケーションがデジタル証明書が正しいことを確認するようにする。
トランスポートレイヤーセキュリティチートシートには、TLSを安全に構成するためのさらなるガイダンスが含まれています。
安全な認証の構成：
データベースは常に、ローカルサーバーからの接続を含めて、認証が必要です。データベースアカウントは次のようにする必要があります。

強力で一意なパスワードで保護されている。

単一のアプリケーションまたはサービスによって使用されている。

権限セクションで議論されたように、必要な最小限の権限で構成されている。
独自のユーザーアカウントを持つシステムと同様に、通常のアカウント管理プロセスが適用されるべきです。これには、次のことが含まれます。

まだ必要かどうかを確認するためのアカウントの定期的なレビュー。

権限の定期的なレビュー。

アプリケーションが廃止された場合は、ユーザーアカウントを削除する。

スタッフが退社した場合、またはそれらの情報が侵害された可能性があると思われる場合は、パスワードを変更する。
Microsoft SQL Serverの場合、既存のWindowsアカウントを使用するWindows認証または統合認証の使用を検討してください。これにより、アプリケーションはそのWindowsユーザーの資格情報を使用して接続するため、アプリケーション内に資格情報を保存する必要がなくなります。Windowsネイティブ認証プラグインは、MySQLでも同様の機能を提供します。

データベース資格情報の安全な保存：
データベース資格情報は、特に暗号化されていない場合は、アプリケーションのソースコードに保存してはいけません。代わりに、次のような構成ファイルに保存する必要があります。

ウェブルートの外側にある。
必要なユーザーのみが読み取ることができるように適切な権限を持っている。
ソースコードリポジトリにチェックされていない。
可能な限り、これらの資格情報は、ASP.NETで利用可能なweb.config暗号化などの組み込み機能を使用して暗号化されるか、その他の方法で保護される必要があります。
安全な権限の設定：
開発者がデータベースユーザーアカウントに権限を割り当てるときは、最小特権の原則を適用する必要があります（つまり、アカウントはアプリケーションが機能するために必要な最小限の権限のみを持つ必要があります）。この原則は、データベースで利用可能な機能に応じて、より粒度の細かいレベルで適用できます。すべての環境で次の操作を行うことができます。

ビルトインのroot、sa、またはSYSアカウントを使用しないでください。

データベースインスタンスに対する管理権限をアカウントに付与しないでください。

アカウントが許可されたホストからのみ接続できるようにします。これは、localhostまたはアプリケーションサーバーのアドレスであることが多いでしょう。

アカウントは必要な特定のデータベースにのみアクセスする必要があります。開発、UAT、および本番環境はすべて、別々のデータベースとアカウントを使用する必要があります。

データベースが必要とする権限のみを付与します。ほとんどのアプリケーションは、SELECT、UPDATE、およびDELETE権限のみが必要です。アカウントはデータベースの所有者ではないようにしてください。これにより特権エスカレーションの脆弱性が引き起こされる可能性があります。

データベースリンクまたはリンクされたサーバーを使用しないでください。必要な場合は、最小限のデータベース、テーブル、およびシステム権限にアクセスが許可されたアカウントを使用してください。
ほとんどのセキュリティクリティカルなアプリケーションは、次のような粒度の細かいレベルで権限を適用します。

テーブルレベルの権限。

カラムレベルの権限。

行レベルの権限。

基礎となるテーブルへのアクセスをブロックし、すべてのアクセスを制限されたビュー経由で行います。
データベースの構成とハードニング：
データベースサーバーの基礎となるオペレーティングシステムは、CISベンチマークやMicrosoft Security Baselinesなどのセキュアベースラインを基にハードニングする必要があります。

データベースアプリケーションも適切に構成およびハードニングする必要があります。次の原則は、どのデータベースアプリケーションとプラットフォームにも適用される必要があります。

必要なセキュリティ更新プログラムとパッチをインストールします。
データベースサービスを低特権ユーザーアカウントで実行するように構成します。
デフォルトのアカウントとデータベースを削除します。
トランザクションログをメインのデータベースファイルとは別のディスクに保存します。
データベースの定期的なバックアップを構成します。バックアップが適切な権限で保護され、理想的には暗号化されていることを確認してください。
上記の一般的な推奨事項に加えて、特定のデータベースソフトウェアについてのさらなる推奨事項が次のセクションに示されています。
Microsoft SQL Serverのハードニング：

必要ないxp_cmdshell、xp_dirtreeなどのストアドプロシージャを無効にします。
コモンランゲージランタイム（CLR）の実行を無効にします。
SQL Browserサービスを無効にします。
必要な場合を除き、ミックスモード認証を無効にします。
サンプルのNorthwindおよびAdventureWorksデータベースが削除されていることを確認します。
SQL Serverのセキュリティに関するMicrosoftの記事を参照してください。
MySQLまたはMariaDB Serverのハードニング：

mysql_secure_installationスクリプトを実行して、デフォルトのデータベースとアカウントを削除します。
すべてのユーザーにFILE権限を無効にして、ファイルの読み取りまたは書き込みを防止します。
Oracle MySQLおよびMariaDBのハードニングガイドを参照してください。
PostgreSQL Serverのハードニング：

PostgreSQL Server Setup and Operation documentationおよび古いSecurity documentationを参照してください。
MongoDB：

MongoDBセキュリティチェックリストを参照してください。
Redis：

Redisセキュリティガイドを参照してください。